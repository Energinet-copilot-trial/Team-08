<!DOCTYPE html>

<head>
  <title>Goose Alert</title>
</head>
<body>
  <center>
    <img src="canadagoose.webp" />
    <h1 style="color: red">Goose Alert!!</h1>
    <h2>High Risk Flights!</h2>
    <ul
      id="aircrafts"
      style="
        display: inline-block;
        list-style: none;
        text-align: left;
        font-size: 60px;
      "
    ></ul>
  </center>
  <script type="text/javascript">
    fetch("http://localhost:3000/alert")
      .then((data) => data.json())
      .then((json) => {
        // insert list item into ul#aircrafts for each aircraft
        json.forEach((aircraft) => {
          const li = document.createElement("li");
          li.innerText = ` ${aircraft[9]}: `;

          const img = document.createElement("img");
          img.src = `https://www.skybrary.aero/sites/default/files/${aircraft[9]}.jpg`;
          img.style.width = "80px";

          // prepend img to li
          li.insertBefore(img, li.firstChild);

          // append link to li
          const link = document.createElement("a");
          link.href = `https://www.flightradar24.com/${aircraft[1]}/${aircraft[0]}`;
          link.innerText = aircraft[1];
          link.referrerPolicy = "no-referrer";
          li.appendChild(link);

          document.getElementById("aircrafts").appendChild(li);
        });
      });

    // play mp3 sound on repeat
    const audio = new Audio("canada_goose.mp3");
    audio.loop = true;
    audio.play();
  </script>
</body>
